# 2026년 연말정산 세금 계산 로직

## 개요

대한민국 2026년 세법 기준으로 근로소득세 및 지방소득세를 계산하는 라이브러리입니다.

## 계산 프로세스

### 1. 근로소득공제
총급여에서 근로소득공제를 차감하여 근로소득금액을 산출합니다.

| 총급여 구간 | 공제율 | 공제액 |
|------------|--------|---------|
| 500만원 이하 | 70% | - |
| 500만원 초과 ~ 1,500만원 이하 | 40% | 350만원 + 초과액의 40% |
| 1,500만원 초과 ~ 4,500만원 이하 | 15% | 750만원 + 초과액의 15% |
| 4,500만원 초과 ~ 1억원 이하 | 5% | 1,200만원 + 초과액의 5% |
| 1억원 초과 | 2% | 1,475만원 + 초과액의 2% |

**근로소득금액 = 총급여 - 근로소득공제**

### 2. 소득공제
근로소득금액에서 각종 소득공제를 차감하여 과세표준을 산출합니다.

#### 인적공제
- 기본공제: 1인당 150만원
- 추가공제:
  - 경로우대(70세 이상): 100만원
  - 장애인: 200만원
  - 부녀자: 50만원
  - 한부모: 100만원

#### 기타 소득공제
- 연금보험료
- 특별소득공제 (건강보험료, 고용보험료)
- 주택자금 공제
- 개인연금저축 공제
- 소기업소상공인 공제부금

**과세표준 = 근로소득금액 - 소득공제 합계**

### 3. 산출세액 계산 (근로소득세)
과세표준에 누진세율을 적용하여 산출세액을 계산합니다.

| 과세표준 | 세율 | 누진공제액 |
|----------|------|-----------|
| 1,400만원 이하 | 6% | - |
| 1,400만원 초과 ~ 5,000만원 이하 | 15% | 126만원 |
| 5,000만원 초과 ~ 8,800만원 이하 | 24% | 576만원 |
| 8,800만원 초과 ~ 1.5억원 이하 | 35% | 1,544만원 |
| 1.5억원 초과 ~ 3억원 이하 | 38% | 1,994만원 |
| 3억원 초과 ~ 5억원 이하 | 40% | 2,594만원 |
| 5억원 초과 ~ 10억원 이하 | 42% | 3,594만원 |
| 10억원 초과 | 45% | 6,594만원 |

**산출세액 = 과세표준 × 세율 - 누진공제액**

### 4. 세액공제
산출세액에서 각종 세액공제를 차감하여 결정세액을 산출합니다.

#### 근로소득세액공제
| 산출세액 | 공제율 | 한도 |
|----------|--------|------|
| 130만원 이하 | 55% | - |
| 130만원 초과 | 30% | 최대 66만원 |

#### 기타 세액공제
- 자녀세액공제: 1명 15만원, 2명 30만원, 3명 이상 추가 1명당 30만원
- 연금계좌세액공제
- 특별세액공제:
  - 보장성보험료: 12%, 한도 100만원
  - 의료비: 15% (난임시술비 20%)
  - 교육비: 15%
  - 기부금: 15% (1천만원 초과분 30%)
- 표준세액공제: 13만원 (특별세액공제 미신청 시 자동 적용)

**결정세액 = 산출세액 - 세액공제 합계**

### 5. 지방소득세
결정세액의 10%를 지방소득세로 계산합니다.

**지방소득세 = 결정세액 × 10%**

### 6. 총 납부세액
**총 납부세액 = 결정세액 + 지방소득세**

## 사용 예시

### API 호출

```bash
curl -X POST http://localhost:3001/api/tax/calculate \
  -H "Content-Type: application/json" \
  -d '{
    "totalSalary": 50000000,
    "incomeDeductions": {
      "basicDeduction": 1500000,
      "pensionInsurance": 2000000
    },
    "taxCredits": {
      "childTaxCredit": 300000
    }
  }'
```

### TypeScript 코드

```typescript
import { calculateTax } from '@/lib/services/tax-calculator.service';

const input = {
  totalSalary: 50_000_000, // 5천만원
  incomeDeductions: {
    basicDeduction: 1_500_000, // 본인 기본공제
    pensionInsurance: 2_000_000, // 국민연금
  },
  taxCredits: {
    childTaxCredit: 300_000, // 자녀 2명
  },
};

const result = calculateTax(input);
console.log('총 납부세액:', result.totalTax);
console.log('근로소득세:', result.finalIncomeTax);
console.log('지방소득세:', result.localIncomeTax);
```

## 파일 구조

```
lib/
├── types/
│   └── tax.types.ts          # 타입 정의
├── constants/
│   └── tax.constants.ts      # 세율 및 상수
├── services/
│   ├── deduction.service.ts  # 소득공제 계산
│   ├── tax-credit.service.ts # 세액공제 계산
│   ├── income-tax.service.ts # 소득세 계산
│   └── tax-calculator.service.ts # 메인 계산 로직
└── index.ts                   # Export 모듈
```

## 주요 함수

### `calculateTax(input: TaxCalculationInput): TaxCalculationResult`
세금 계산 메인 함수

### `validateTaxCalculationInput(input: TaxCalculationInput)`
입력값 검증 함수

## 참고 자료

- 소득세법 제55조 (세율)
- 지방세법 제103조의3 (지방소득세)
- 2026년 귀속 근로소득 간이세액표
